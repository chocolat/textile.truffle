(trigger
    (key [[ctrl][shift]H]))

(name [Convert Document / Selection to HTML])

(only-in text.html.textile)

(input selection document)

(output replace-selected)

(save nothing)

(script [#!/usr/bin/env ruby
begin 
  require 'rubygems'
  require 'redcloth'
rescue LoadError
  require ENV['TM_BUNDLE_SUPPORT'] + '/lib/redcloth'
end

contents = []
$stdin.each_line { |line| contents << line }

puts(RedCloth.new(contents.join()).to_html(:textile))])